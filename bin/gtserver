#!/bin/sh
# This script should be executed from the base directory of the PHP.Gt
# application wishing to be served (the "approot"), either by referencing the
# script absolutely, or by having it within the user's environment path.
# Alternatively, the base directory of the PHP.Gt application (the "gtroot")
# can be passed as the --approot argument.
set -e
PORT=8080
APPROOT=$(pwd)
GTROOT=$(dirname $0)/..

while :
do
	case $1 in
	-a | --approot)
		APPROOT=$2
		shift 2
		;;
	-a=* | --approot=*)
		APPROOT=${1#*=}
		shift
		;;
	-p | --port)
		PORT=$2
		shift 2
		;;
	-p=* | --port=*)
		PORT=${1#*=}
		shift
		;;
	-*)
		printf >&2 'ERROR: Unknown option: %s\n' "$1"
		exit 1
		;;
	*)
		break
		;;
	esac
done

APPROOT=$(readlink -f $APPROOT)
GTROOT=$(readlink -f $GTROOT)
echo "GTROOT is $GTROOT"
php -S localhost:$PORT -t $APPROOT/www $GTROOT/Go.php